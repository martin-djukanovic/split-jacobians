K<t>:=FunctionField(QQ);
A2:=AffineSpace(K,2);
A1:=AffineSpace(K,1);
Phi:=func<n,j1,j2|map<A2->A1|[CoordinateRing(A2)!ClassicalModularPolynomial(n)]>([j1,j2])[1]>;
R<x>:=PolynomialRing(K);
K<s>:=ext<K|x^2 - (t - 1)*(t^3 + 17*t^2 + 19*t + 7)>; // s^2 = (t - 1)*(t^3 + 17*t^2 + 19*t + 7) is a model of X0(11)
R<x>:=PolynomialRing(K);
a:=2*(2*t^5 - 38*t^4 + 6*t^3 + 30*t^2 - 9);
b:=2*(s*t^3*(t + 6)*(t^2 - 1)*(t^2 + 12*t - 9) + t^10 + 26*t^9 + 175*t^8 + 108*t^7 - 625*t^6 + 72*t^5 + 567*t^4 - 54*t^3 - 270*t^2 + 54);
c:=(-2*b);

// the parametrization found above only works geometrically; we need a twist and it's a bit ugly
u1 := 121*t^15 + 3751*t^14 + 34364*t^13 + 69212*t^12 - 189970*t^11 - 180806*t^10 + 368484*t^9 + 175140*t^8 - 270639*t^7 - 135369*t^6 + 92961*t^5 + 60453*t^4 - 8829*t^3 - 13041*t^2 - 1944*t + 1458; 
u2 := 121*t^13 + 2783*t^12 + 15851*t^11 - 605*t^10 - 74415*t^9 + 44439*t^8 + 69885*t^7 - 65187*t^6 - 29646*t^5 + 39690*t^4 + 9963*t^3 - 14013*t^2 - 1458*t + 1944;
u:=(u1-u2*s)*(2*t^5 - 38*t^4 + 6*t^3 + 30*t^2 - 9);
A:=u*a;
B:=u^2*b;
C:=u^3*c;

E1:=EllipticCurve(x^3 + A*x^2 + B*x + C);
E2:=EllipticCurve(x^3 + B/C^2*x^2 + A/C^3*x + 1/C^4);
j1:=jInvariant(E1);
j2:=jInvariant(E2);
Phi(11,j1,j2) eq 0;
(x-j1)*(x-j2) eq x^2 + (t^11 + 55*t^10 + 1188*t^9 + 12716*t^8 + 69630*t^7 + 177408*t^6 + 133056*t^5 - 132066*t^4 - 187407*t^3 - 40095*t^2 + 24300*t + 6750)*x + t^12 -
    684*t^11 + 157410*t^10 - 12515580*t^9 + 75763215*t^8 - 76077144*t^7 - 207606564*t^6 + 34321320*t^5 + 418524975*t^4 + 477130500*t^3 + 270641250*t^2 +
    82012500*t + 11390625;

d0:=512*(2*t^5 - 38*t^4 + 6*t^3 + 30*t^2 - 9)^10 * (s*(-219119363029248*t^58 - 16561771855627328*t^57 - 518363373139524352*t^56 - 8534192476462204464*t^55 - 75662984260894101984*t^54 - 290805992774237068304* t^53 + 420524481076809470372*t^52 + 6672919490640567812252*t^51 + 5883008361203924726732* t^50 - 70863702868296560810500*t^49 - 77243073518708419939429*t^48 + 512703367285112918009446*t^47 + 294457034952527946497874*t^46 - 2472026155373435481802212*t^45 + 2709298069735740982673*t^44 + 7690683235265678655372712*t^43 - 3295798344019259725410170*t^42 - 16139887353017934659326436*t^41 + 12549760301951140259337235*t^40 + 23902203710379916888123362*t^39 - 27164874316457846745606750*t^38 - 25444657257014371388704380*t^37 + 41197580077109528051010945*t^36 + 18960270764810259013733844*t^35 - 47506108900434987650787090*t^34 - 8318682155288158175793852*t^33 + 43609476761580332440904553*t^32 - 639523957905992429980542*t^31 - 32858336809148696587698210*t^30 + 4759255269414542322669924*t^29 + 20790304054562654447620950*t^28 - 4690162426450261430821482*t^27 - 11249773120025578048294926*t^26 + 2843103032827108620418044*t^25 + 5278722813856668673433061*t^24 - 1129418077404390602816160*t^23 - 2163983222974115734736364*t^22 + 207056705892101495682048*t^21 + 772821044540399515330629*t^20 + 86379208959330910619802*t^19 - 236309316157915630074252*t^18 - 98885380563173831925600*t^17 + 59668299521756610406920*t^16 + 51295938055846887376494*t^15 - 11643439111670858180382*t^14 - 18332823161097050145156*t^13 + 1513871700547681986075* t^12 + 4857379987673887940484*t^11 - 59512914424709334450*t^10 - 961776412838855969076* t^9 - 22686980893998036813*t^8 + 138844261273810288086*t^7 + 5383673116060732326*t^6 - 13754922580983020292*t^5 - 558089159101032141*t^4 + 823763628416938968*t^3 + 30420308710625526*t^2 - 21804759670167144*t - 880315431289272) + 219119363029248*t^60 + 18314726759861312*t^59 + 644064847730636288*t^58 + 12220711419907030128*t^57 + 131344939435797516000*t^56 + 722800332829899964992* t^55 + 746146018481225844636*t^54 - 11886281963150614038316*t^53 - 40588979317043033240848* t^52 + 93843059551871558196576*t^51 + 476488270765940269974545*t^50 - 652913303114279331746714*t^49 - 3011144887825618440969621*t^48 + 4213581561531005560604784*t^47 + 11166879302342827118816685*t^46 - 19006031666049496301471490*t^45 - 25515776252765162269586681*t^44 + 57248977919742138671621548*t^43 + 36070730438239844613829053*t^42 - 121867708012235623783684558*t^41 - 25252973059109340642541695*t^40 + 193605017981454770195015256*t^39 - 14759584377123721831715607*t^38 - 238731549958866099413191482*t^37 + 69383627890682023618239375*t^36 + 234596658107141562124354572*t^35 - 111400274750071865351068701*t^34 - 186378833081377112959838178*t^33 + 122824915587663361993172655*t^32 + 119696237521002855505454472*t^31 - 105729918546955686478381710*t^30 - 60597406155052894912690392*t^29 + 75128432771294701314319584*t^28 + 22016589510115247113568088*t^27 - 45645445691983466447354757*t^26 - 3366610084889049003185646*t^25 + 24364781056130697647766855*t^24 - 2500556912174865978144000*t^23 - 11660836548688120708396407*t^22 + 2715221473759622367369306*t^21 + 5052541975369531509667617*t^20 - 1555289994628857249058500*t^19 - 1972740173084282260793448*t^18 + 644843385490096355603364*t^17 + 681559065851042637545076*t^16 - 206130876265886294435472*t^15 - 202855420921228054438905*t^14 + 51404010849744398516754* t^13 + 50439152999862160251057*t^12 - 9912769406157851027244*t^11 - 10130163860288175490179* t^10 + 1446752781068639115978*t^9 + 1579569007487046945633*t^8 - 154785752476228657512* t^7 - 181350323474339812869*t^6 + 11617303465952907606*t^5 + 14122310804378225361*t^4 - 564491812285565604*t^3 - 643165184058740640*t^2 + 13701347198004708*t + 12132566186737986);
d1:=1408*(2*t^5 - 38*t^4 + 6*t^3 + 30*t^2 - 9)^8 * (s*(-54875873536*t^48 - 3484617969536*t^47 - 87527018289920*t^46 - 1065157854044240*t^45 - 5644779293343872*t^44 + 1491430209929792*t^43 + 124708324172373216*t^42 + 176035446991384112*t^41 - 1364792971364691616*t^40 - 1521665691292720512*t^39 + 9858036003273074299*t^38 + 1595201419549340416*t^37 - 39685823063439104447*t^36 + 21542155566495475354* t^35 + 85052982583188776289*t^34 - 91369527803590384102*t^33 - 102015780173052901707* t^32 + 181721497710222931584*t^31 + 60558543556465992132*t^30 - 231392093860947817980* t^29 + 14184202143831118236*t^28 + 209734590200487692328*t^27 - 73151972616972041766* t^26 - 140270673843191303604*t^25 + 91544286840506937306*t^24 + 68163278356469937780* t^23 - 77973519524172855417*t^22 - 21446377872065074656*t^21 + 52734446918844409809* t^20 + 1775517588707382054*t^19 - 29883236115217656969*t^18 + 2370124004155197930* t^17 + 14355739744942883103*t^16 - 1540395402419704320*t^15 - 5772650214271199130*t^14 + 494557227865729800*t^13 + 1896209478670692834*t^12 - 82542722072934348*t^11 - 494158448093319162*t^10 + 218747643821244*t^9 + 98742931534465902*t^8 + 3198712899795768*t^7 - 14464604756171340*t^6 - 705022295901912*t^5 + 1445096847966588*t^4 + 66395492052912*t^3 - 85524651326520*t^2 - 2301794265312*t + 2128229886240) + 54875873536*t^50 + 3923624957824*t^49 + 113702809966592*t^48 + 1670630804703696*t^47 + 12163182493380864*t^46 + 24869749316257296*t^45 - 189587568711640000*t^44 - 882281436608690096*t^43 + 1511580692427568928*t^42 + 9547205601758394416*t^41 - 13081040798017634331*t^40 - 50865808539598466296*t^39 + 88783352975914157668*t^38 + 126589810640470751416*t^37 - 323708428909251917846* t^36 - 125702930208807205192*t^35 + 693231448927692008388*t^34 - 79863160321729343752* t^33 - 985298707877138247893*t^32 + 432288616011076690656*t^31 + 1009403432397769664256* t^30 - 716514290484052098816*t^29 - 786427166685832957548*t^28 + 773539785778171786704* t^27 + 489497201751309827112*t^26 - 619548076317903476112*t^25 - 262459222821494959509* t^24 + 381719139815739355848*t^23 + 135752731647951226500*t^22 - 177682156358846697000* t^21 - 72725313797852602338*t^20 + 55870934688767472264*t^19 + 37688537180499522588*t^18 - 5531445963347509656*t^17 - 16590295998569434527*t^16 - 5879617144183124640*t^15 + 5608622981074852584*t^14 + 4374487767713717664*t^13 - 1331271537657867900*t^12 - 1727149347091287936*t^11 + 185207712266991960*t^10 + 457304489737619904*t^9 - 2214789863287788*t^8 - 83694690167619312*t^7 - 4719647260654416*t^6 + 10234391895961776*t^5 + 937314455499792*t^4 - 753081377095152*t^3 - 81174866262912*t^2 + 24960899452176*t + 2831182840170);
d2:=-704*(2*t^5 - 38*t^4 + 6*t^3 + 30*t^2 - 9)^6 * (s*(-56689952*t^37 - 2947877504*t^36 - 57894613480*t^35 - 508593904368*t^34 - 1536992151112*t^33 + 3673147491156*t^32 + 21298507087572*t^31 - 27630675518556*t^30 - 110398784925396*t^29 + 198225088897655*t^28 + 179729314155590*t^27 - 600554108072528*t^26 + 64238143164192*t^25 + 912541860172564*t^24 - 565163330941134*t^23 - 814034092342698*t^22 + 871769616746724*t^21 + 453523827250782*t^20 - 750491331514830*t^19 - 138639653530578*t^18 + 384234813902448*t^17 - 16027616622636*t^16 - 75301981865262*t^15 + 57900127246398*t^14 - 50233285633608*t^13 - 50373565147701*t^12 + 52146201975624*t^11 + 28797868318338*t^10 - 23995310521176*t^9 - 11379339186975*t^8 + 6765626449422*t^7 + 3024644763942*t^6 - 1206705523536*t^5 - 506851756371*t^4 + 126704037456*t^3 + 47184520626*t^2 - 5981899896*t - 1806899400) + 56689952*t^39 + 3401397120*t^38 + 79720245000*t^37 + 894085577968*t^36 + 4387207040304*t^35 + 1255817075436*t^34 - 54265117251884*t^33 - 48357025093080*t^32 + 377261327161224*t^31 + 46039959653837*t^30 - 1404698154783930*t^29 + 829106043737217*t^28 + 2571832907013780*t^27 - 3045154515716484*t^26 - 2357316305389500*t^25 + 5292695614943484*t^24 + 473434739927928*t^23 - 5995806007297842*t^22 + 1761156714012516*t^21 + 5102515425457332*t^20 - 2971940720340888*t^19 - 3629526150008412*t^18 + 2802961350503892*t^17 + 2336505602252598*t^16 - 1835629730333496*t^15 - 1366912937488779*t^14 + 862394481989622*t^13 + 679620092709411*t^12 - 284684564174508*t^11 - 265691678438979*t^10 + 61856812190754*t^9 + 76863381620733*t^8 - 7388839633752*t^7 - 15606121050153*t^6 + 109527510042*t^5 + 2077659909297*t^4 + 80466544692*t^3 - 160061526144*t^2 - 6753552228*t + 5213436210);
d3:=-176*(2*t^5 - 38*t^4 + 6*t^3 + 30*t^2 - 9)^4 * (s*(-117128*t^25 - 4216608*t^24 - 49896528*t^23 - 185062240*t^22 + 257213088*t^21 + 1669542512*t^20 - 1633935600*t^19 - 4398322827*t^18 + 4271876404*t^17 + 6537715845*t^16 - 6007765242*t^15 - 7659025662*t^14 + 5589813042*t^13 + 7352126712*t^12 - 3231098046*t^11 - 5428145313*t^10 + 863660718*t^9 + 2847193821*t^8 + 128431332*t^7 - 988719858*t^6 - 170851356*t^5 + 215552178*t^4 + 48376440*t^3 - 27354996*t^2 - 4723920*t + 1574640) + 117128*t^27 + 5153632*t^26 + 79998424*t^25 + 481864592*t^24 + 413461840*t^23 - 4447115904*t^22 - 3833833696*t^21 + 18743212491*t^20 + 5917013284*t^19 - 37429271082*t^18 - 3816046268*t^17 + 45344672149*t^16 - 2567947080*t^15 - 36941748324*t^14 + 10965802464*t^13 + 22247062965*t^12 - 14680660644*t^11 - 11791131822*t^10 + 11081082852*t^9 + 6001007391*t^8 - 5045720040*t^7 - 2507755140*t^6 + 1365591960*t^5 + 698798988*t^4 - 203216040*t^3 - 108055296*t^2 + 12964536*t + 6757830);
d4:=22*(2*t^5 - 38*t^4 + 6*t^3 + 30*t^2 - 9)^2 * (s*(-484*t^12 - 7260*t^11 - 11132*t^10 + 60500*t^9 - 35939*t^8 - 49782*t^7 + 80034*t^6 + 9612*t^5 - 59319*t^4 - 3240*t^3 + 23058*t^2 + 648*t - 3240) + 484*t^14 + 11132*t^13 + 54208*t^12 - 79376*t^11 - 207033*t^10 + 290938*t^9 + 262761*t^8 - 244056*t^7 - 251355*t^6 + 67122*t^5 + 124119*t^4 + 11124*t^3 - 26784*t^2 - 6804*t + 2430);
D11 := 11*x^5 + d4*x^4 + d3*x^3 + d2*x^2 + d1*x + d0;

E:=IsogenyFromKernel(E1,D11);
IsIsomorphic(E,E2);

/* Thus the Jacobian of the hyperelliptic curve y^2 = x^6 + A*x^4 + B*x^2 + C splits as E1 x E2, where E1 and E2 are 11-isogenous
   (and, moreover, the 11-isogeny induces the gluing isomorphism E1[2] --> E2[2]) */
